# 分组交换
{: id="20210308110522-uba5xlx" updated="20210308110529"}

## 报文
{: id="20210308110834-fyxx3tv" updated="20210308110836"}

在各种网络应用中，端系统彼此交换报文（message）。报文能够包含协议设计者需要的任何东西。
{: id="20210308110837-l913fnd" updated="20210308110905"}

为了从源端系统向目的端系统发送一个报文，源将长报文划分为较小的数据块，称之为**分组（packet）**。
{: id="20210308110907-yvjil8y" updated="20210308113905"}

在源和目的地之间，每个分组都通过**通信链路和分组交换机（packet switch ）**传送。
{: id="20210308110919-ju0ldvx" updated="20210308110944"}

{: id="20210308110855-ky2tdo9"}

!((20210308075125-rp3e629 "{{.text}}"))
{: id="20210308110530-0wu69ka" updated="20210308110542"}

!((20210308075200-rv44u32 "{{.text}}"))
{: id="20210308110545-xiexykv" updated="20210308110732"}

!((20210308074927-9qd5dm7 "{{.text}}"))
{: id="20210308110739-lgsleyp" updated="20210308110743"}

## 存储转发传输
{: id="20210308110746-4lsf596" updated="20210308110829"}

多数分组交换机在链路的输入端使用**存储转发传输（store-and-forward transmission）**机制。
{: id="20210308110829-2hoza3s" updated="20210308111053"}

**存储转发传输是指在交换机能够开始向输岀链路传输该分组的第一个比特之前，必须接收到整个分组。**
{: id="20210308111054-3ljic21" updated="20210308111109"}

**即，仅当路由器已经接收完了该分组的所有比特后，它才能开始向出链路传输（即“转发”）该分组。**
{: id="20210308111110-1h2x8wz" updated="20210308111324"}

### 单组时延的计算
{: id="20210308111903-lvipery" updated="20210308112039"}

注：设单条路径长度为L。
{: id="20210308111837-3x49cf3" updated="20210308111851"}

![image.png](assets/image-20210308111622-tps292s.png)
{: id="20210308111325-xbf1g39" updated="20210308111622"}

## 输出缓存、输出队列
{: id="20210308111853-e1tnwa4" updated="20210308112412"}

每台分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有一个 **输出缓存** （ **output buffer** ，也称为 **输出队列（output queue）** ）,它用于存储路由器准备发往那条链路的分组。
{: id="20210308112055-bmz045p" updated="20210308114001"}

### 排队时延
{: id="20210308112241-96wu69q" updated="20210308112352"}

如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。因此，除了存储转发时延以外，分组还要承受输岀缓存的排队时延（queuingdelay）。
{: id="20210308112353-8lyjkjp" updated="20210308112402"}

### 分组丢失、丢包
{: id="20210308112414-zdryhcv" updated="20210308112441"}

缓存空间的大小是有限的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了。在此情况下，将出现**分组丢失（丢包）（packet loss）**,到达的分组或已经排队的分组之一将被丢弃。
{: id="20210308112441-tszlaee" updated="20210308112501"}

## 转发表和路由选择协议
{: id="20210308112535-vobcs1g" updated="20210308112545"}

### 转发表
{: id="20210308112545-kyjlond" updated="20210308112642"}

每台路由器具有一个**转发表(forwarding table)**,用于将目的地址(或目的地址的一部分，目的地址即为端系统的IP地址)映射成为输岀链路。
{: id="20210308112642-4wdight" updated="20210308112735"}

当某分组到达一台路由器时，路由器检查该地址，并用这个目的地址搜索其转发表，以发现适当的出链路。路由器则将分组导向该出链路。
{: id="20210308112502-a30vq2x" updated="20210308112848"}

**一个合适的类比**
{: id="20210308112902-ookjwhr" updated="20210308113047"}

![image.png](assets/image-20210308113055-hw0mwgq.png)
{: id="20210308113048-le78vqb" updated="20210308113055"}

### 路由选择协议
{: id="20210308113056-7lcnoik" updated="20210308113130"}

因特网具=有一些特殊的路由选择协议（routingprotocol），用于自动地设置这些转发表。
{: id="20210308113130-kv7j7ei" updated="20210308113147"}


{: id="20210308110441-ehqr6k1" type="doc"}
